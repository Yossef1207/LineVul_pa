index,processed_func,target,vul_func_with_fix,cve_id,cwe_id,commit_id,file_path,file_language,flaw_line_index,flaw_line
35,void IMB_flipy(struct ImBuf *ibuf)
{
  int x, y;

  if (ibuf == NULL) {
    return;
  }

  if (ibuf->rect) {
    unsigned int *top, *bottom, *line;

    x = ibuf->x;
    y = ibuf->y;

    top = ibuf->rect;
    bottom = top + ((y - 1) * x);
    line = MEM_mallocN(x * sizeof(int), "linebuf");

    y >>= 1;

    for (; y > 0; y--) {
      memcpy(line, top, x * sizeof(int));
      memcpy(top, bottom, x * sizeof(int));
      memcpy(bottom, line, x * sizeof(int));
      bottom -= x;
      top += x;
    }

    MEM_freeN(line);
  }

  if (ibuf->rect_float) {
    float *topf = NULL, *bottomf = NULL, *linef = NULL;

    x = ibuf->x;
    y = ibuf->y;

    topf = ibuf->rect_float;
    bottomf = topf + 4 * ((y - 1) * x);
    linef = MEM_mallocN(4 * x * sizeof(float), "linebuf");

    y >>= 1;

    for (; y > 0; y--) {
      memcpy(linef, topf, 4 * x * sizeof(float));
      memcpy(topf, bottomf, 4 * x * sizeof(float));
      memcpy(bottomf, linef, 4 * x * sizeof(float));
      bottomf -= 4 * x;
      topf += 4 * x;
    }

    MEM_freeN(linef);
  }
},1,void IMB_flipy(struct ImBuf *ibuf)
{
  size_t x_size, y_size;

  if (ibuf == NULL) {
    return;
  }

  if (ibuf->rect) {
    unsigned int *top, *bottom, *line;

    x_size = ibuf->x;
    y_size = ibuf->y;

    const size_t stride = x_size * sizeof(int);

    top = ibuf->rect;
    bottom = top + ((y_size - 1) * x_size);
    line = MEM_mallocN(stride, "linebuf");

    y_size >>= 1;

    for (; y_size > 0; y_size--) {
      memcpy(line, top, stride);
      memcpy(top, bottom, stride);
      memcpy(bottom, line, stride);
      bottom -= x_size;
      top += x_size;
    }

    MEM_freeN(line);
  }

  if (ibuf->rect_float) {
    float *topf = NULL, *bottomf = NULL, *linef = NULL;

    x_size = ibuf->x;
    y_size = ibuf->y;

    const size_t stride = x_size * 4 * sizeof(float);

    topf = ibuf->rect_float;
    bottomf = topf + 4 * ((y_size - 1) * x_size);
    linef = MEM_mallocN(stride, "linebuf");

    y_size >>= 1;

    for (; y_size > 0; y_size--) {
      memcpy(linef, topf, stride);
      memcpy(topf, bottomf, stride);
      memcpy(bottomf, linef, stride);
      bottomf -= 4 * x_size;
      topf += 4 * x_size;
    }

    MEM_freeN(linef);
  }
},CVE-2022-0545,['CWE-190'],82858ca3f4e6dc6f840af9306c350900abd491fc,files/2022_2/132,c,[],
